<h1> Pet Page </h1>

<h3>Pet name: <%= @pet.name %> </h3>

<p> Pet Bio: <%= @pet.bio %> </p>

<p><b>Age:</b> <%= @pet.age %></p>

<p><b>Owner:</b> <%= @pet.user.name %></p>


<ul>

 <% if @pet.pictures.attached? %>
   
   <% @pet.pictures.each do |picture| %>
   <% variant = picture.variant(resize_to_limit: [300, 300]).processed %>
    <li><img src="<%=(url_for(variant))%>"></li>
    <% end %>
    <% end %>
</ul>
<br><br>

<% if @pet.requestie_relationships.length > 0 %>
<label> Meeting Requests: </label>
<ul> <% @pet.requestie_relationships.each do |meeting| %>
  
   <li><%= link_to 'Meeting:', meeting_path(meeting) %>
   <%= meeting.requester.name %> and 
    <%= meeting.requestie.name %> at 
    <%= meeting.location.name %>, 
    <%= meeting.time_nice %> Status = 
    <%= meeting.status %> 
   </li>
   
   <% if meeting.status != "Accepted" %>
      <%= form_for meeting do |f|%>
         <%= f.hidden_field :status, value: meeting.accept %>
         <%= f.submit "Accept the meeting!" %>
         <% end %>
      <% end %>
   <% end %>
</ul>
<% end %>

<% if @pet.requested_relationships.length %>
<label> Confirmed Meetings: </label>
<p> <% @pet.requested_relationships.each do |meeting| %>
  
   <li><%= link_to 'Meeting:', meeting_path(meeting) %>
   <%= meeting.requestie.name %> at 
    <%= meeting.location.name %>, 
    <%= meeting.time_nice %> Status = 
   <%= meeting.status %> 
   </li>
 
   <% end %>
</p>
<% end %>


<%# render 'meetings/form' %>
<br><br><br>
<% if @pet.user.id != @current_user.id %>
   <%= form_tag meetings_path do %>

   <label> Time: </label>
   <%= datetime_select(:meeting, :time, default: {hour: 9, min: 0}) %><br><br>

   <label> My Pets: </label>
   <%= collection_select(:meeting, :requestie_id, @current_user.pets , :id, :name ) %><br><br>
   
   <label> Other Pets: </label>
   <%# hidden_field(:meeting, :requester_id, :value => @pet.id ) %>
   <%= collection_select(:meeting, :requester_id, (Pet.all - @current_user.pets), :id, :name ) %><br><br>

   <label> Place: </label>
   <%= collection_select(:meeting, :location_id, Location.all, :id, :name ) %><br><br>

   <%= submit_tag "Make Request"%>
   <% end %>
<% end %>

<br><br><br><br>
<p> 
   Your view count is: <%= cookies[:view_count] %><br>
   This is a cookie test!
</p>